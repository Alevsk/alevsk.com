---
title: System misconfiguration is the number one vulnerability, at least for Mastodon according to Websec
author: Alevsk
type: post
date: 2022-11-19T00:41:33+00:00
url: /2022/11/system-misconfiguration-is-the-number-one-vulnerability-at-least-for-mastodon/
categories:
  - Networking
  - IT News
  - Personal
  - Talks and Events
  - Programming
  - Social Media
  - Technology
tags:
  - hacking
  - Linux
  - Personal
  - Programming
  - Technology
  - twitter

---
![I was one click away to start a twitter infosec.exchange revolution](/images/gilfoyle-1200x626.png)

One time during a security engineering interview someone asked me


> What is the number one vulnerability?
  


That question caught me by surprise. I immediately start thinking about OWASP top 10, RCE, 0days and things like that, then I remembered the security incidents I've deal with in the past and most of them has been related to employees accidentally exposing credentials or private keys so I responded with “developers pushing credentials into public repositories".

The interviewer smiled at me, she liked my answer, but clearly I was wrong. She said


> The number one vulnerability is system misconfiguration
  


Today I'm going to explain why this is true and how I could have replaced everyone's profile picture (or any other user's uploaded content) with a meme at [infosec.exchange][1] Mastodon instance.

  
With all the drama happening lately on Twitter I decided to look at Mastodon. [Mastodon][2] is a free and open-source distributed social network which is super cool by itself. Most of the CyberSecurity people from twitter are gathering at [infosec.exchange][1] now so I went there and created an account.

![](/images/mastodon-alevsk-478x800.png)

Within minutes I start receiving greetings :). Then I start wondering (my hacker mind started kicking in) where is all this user uploaded content stored?
![](/images/html-source-code-1200x376.png)  

A quick look at the source code of the page reveals the content is coming from https://media.infosec.exchange/infosecmedia and when I visited the URL on my browser I found this
![](/images/minio-infosec-exchange.png)  

This looks very familiar to an **AWS S3 xml response**, also “**minio**" is displayed on the response as well so I immediately knew [infosec.exchange][1] was using [MinIO][3].

Full disclosure, at the time of this publication on **11/18/2022**, I'm working as a **Security Software Engineer** at [MinIO](https://www.alevsk.com/2020/03/build-your-own-private-cloud-at-home-with-a-raspberry-pi-minio/). I'm very proud our product is being used by millions around the globe and with Mastodon getting a lot of adoption MinIO will only increase in popularity.

Anyways, my hacker mind (again) started wondering. 

  1. User content is uploaded to MinIO buckets
  2. Buckets must have anonymous read access in order for the browser, or really any other client, to access those resources
  3. Can I query those resources using a tool like the [MinIO Clien][4]t?

I opened my terminal and typed

```Text only
mc alias set infosec https://media.infosec.exchange/ "" "" --debug
```
![](/images/infosec-mc-alias-set-1082x800.png)

That was expected since I knew s3 clients don't need any authentication to download content from the buckets. WIth this I was able to list all the content at https://media.infosec.exchange/infosecmedia.

```Text only
mc ls infosec/infosecmedia
```
![](/images/infosec-exchange-listing.png)  

I noticed there were additional folders in there and I could access them with anonymous credentials as well, this will be equivalent to a [Directory Traversal vulnerability][5].

So far I tried read and list operations only, in S3 IAM policies language that would be the Get and List Object operation, but what about Create/Upload and Delete?.  
I identified where the logo of the server was stored inside the https://media.infosec.exchange/infosecmedia server, I downloaded it with mc, modified it a little bit and uploaded the modified version and it works!
![](/images/infosec-exchange-logo-replace-1200x455.png)  

Original:

![](/images/infosec-logo-original-1020x800.png)

Modified:
![](/images/infosec-logo-modified.png)  

I added a tiny label at the bottom of the logo that says **infosec.exchange** so the change will go unnoticed and because my intention was never to disrupt the server.

At this point I realized the anonymous credentials has **s3:*** privileges, and I can do everything I want content wise, including:

  * Download all the files in the server, including files shared via Direct Messages.
  * Delete all the files in the server
  * Replace everyone's profile picture with an Elon Musk meme, jk but it was possible to replace all the existing files


> This system misconfiguration at the object storage level defeats whatever security mechanism Mastodon has on top.
  


## Timeline of events and disclosure

  * 11/17/2022 – I created my **infosec.exchange** account and start playing around
  * 11/17/2022 – Found anonymous access was enabled and all the files were exposed
  * 11/17/2022 – Reached to **jerry@infosec.exchange** and reported the issue
  * 11/18/2022 – Jerry confirmed is aware of the issue and working on a fix
  * 11/18/2022 – Issue got fixed, thank you so much Jerry.

After reporting this issue I wondered if there may be other Mastodon instances with the same issue (system misconfiguration) so I went to [fediverse.space][6] and started checking some of the most popular, I found similar problems with a couple of them and I already reported the vulnerabilities.

Happy hacking

 [1]: https://infosec.exchange/
 [2]: https://en.wikipedia.org/wiki/Mastodon_(software)
 [3]: https://min.io/
 [4]: https://min.io/docs/minio/linux/reference/minio-mc.html
 [5]: https://en.wikipedia.org/wiki/Directory_traversal_attack
 [6]: https://www.fediverse.space/instances
